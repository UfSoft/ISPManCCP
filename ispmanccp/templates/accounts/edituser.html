<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      py:with="uid=c.userinfo['ispmanUserId']; domain = c.userinfo['ispmanDomain']">
  <xi:include href="../layout.html"/>
  <head>
    <title>${ _("Edit Account") }</title>

    <!--! Unfortunatly we must keep those html vars long -->
    <script type="text/javascript">
      var total_alias = ${c.lengths[uid].aliases or 0};
      var total_forwards = ${c.lengths[uid].forwards or 0};

      function addAliasField() {
        var html = '\n<label for="mailAlias-'+total_alias+'">&nbsp;</label>\n';
        html += '<input id="mailAlias-'+total_alias+'" name="mailAlias-'+total_alias+'" class="email"/><br/>\n';
        new Insertion.Bottom('email_alias', html);
        total_alias++;
      }

      function addForwardsField() {
        var html = '\n<label for="mailForwardingAddress-'+total_forwards+'">&nbsp;</label>\n';
        html += '<input id="mailForwardingAddress-'+total_forwards+'" name="mailForwardingAddress-'+total_forwards+'" class="email"/><br/>\n';
        new Insertion.Bottom('email_forwards', html);
        total_forwards++;
      }

      function checkFieldStatus() {
        if ( document.forms['edit_user'].userPassword.value == "" ) {
          document.forms['edit_user'].restore_btn.disabled = false;
        } else {
          document.forms['edit_user'].restore_btn.disabled = true;
        }
      }


    </script>

  </head>

  <body>
    <h1>${ domain  + ' ' + _('domain')}</h1>
    <form id="edit_user" class="user_input" method="post" accept-charset="UTF-8"
      action="${ h.url_for(action='edit')}">
      <fieldset>
        <legend>
          ${ _("Edit Account") + ' - ' + c.userinfo['mailLocalAddress'] }
        </legend>

        <!--! User ID -->
        <label for="ispmanUserId">${ _("User ID:") }</label>
        <span id="ispmanUserId">${ c.userinfo['ispmanUserId'] }</span><br/>

        <!--! Create Date -->
        <label for="ispmanCreateTimestamp">${ _("Created on:") }</label>
        <span id="ispmanCreateTimestamp">
          ${ h.date_from_tstamp(c.userinfo['ispmanCreateTimestamp']) }
        </span><br/>

        <!--! First Name -->
        <label for="givenName">${ _("First Name:") }</label>
        <input type="text" name="givenName" id="givenName"
        value="${ c.userinfo['givenName'] }"/>
        <span class="error-message" py:if="'givenName' in c.form_errors">
          ${ c.form_errors['givenName']}
        </span><br/>

        <!--! Last Name -->
        <label for="sn">${ _("Last Name:") }</label>
        <input type="text" name="sn" id="sn"
        value="${ c.userinfo['sn'] }"/>
        <span class="error-message" py:if="'sn' in c.form_errors">
          ${ c.form_errors['sn']}
        </span><br/>

        <!--! User Password -->
        <div id="user_password">
          <xi:include href="snippets/password.html"/>
        </div>
        <label for="userPasswordConfirm">${ _("Re-type Password:") }</label>
        <input type="password" name="userPasswordConfirm" id="userPasswordConfirm"/>
        <span class="error-message" py:if="'userPasswordConfirm' in c.form_errors">
          ${ c.form_errors['userPasswordConfirm']}
        </span><br/>

        <!--! FTP Quota -->
        <label for="FTPQuotaMBytes">${ _("FTP Quota:") }</label>
        <input type="text" id="FTPQuotaMBytes" name="FTPQuotaMBytes" class="quota"
        value="${ c.userinfo['FTPQuotaMBytes'] }"/>
        <span id="FTPQuotaUnit" class="quota">${ _("MB") }</span>
        <span class="error-message" py:if="'FTPQuotaMBytes' in c.form_errors">
          ${ c.form_errors['FTPQuotaMBytes']}
        </span><br/>

        <!--! FTP Status -->
        <label for="FTPStatus">${ _("FTP Status:") }</label>
        <select id="FTPStatus" name="FTPStatus">
          <xi:include href="snippets/${c.userinfo['FTPStatus']}_ftp_status.html"/>
        </select><br/>

        <!--! Mailbox Quota -->
        <label for="mailQuota">${ _("Email Quota:") }</label>
        <input type="text" id="mailQuota" name="mailQuota" class="quota"
        value="${ c.userinfo['mailQuota'] }"/>
        <span id="mailQuotaUnit" class="quota">${ _("MB") }</span>
        <span class="error-message" py:if="'mailQuota' in c.form_errors">
          ${ c.form_errors['mailQuota']}
        </span><br/>

        <!--! Email Alias -->
        <div id="email_alias">
          <label>${ _("Email Aliases:") }</label>
          ${ h.tag.input(type="button", name="add_alias_field",
             value="Add Alias Field", onClick="addAliasField()") }<br/>
          <py:if test="'mailAlias' in c.userinfo"> 
            <py:for each="n in range(c.lengths[uid].aliases or 1)">
              <xi:include href="snippets/alias.html"/>
            </py:for>
          </py:if>
        </div>

        <!--! Email Forwards -->
        <div id="email_forwards">
          <label>${ _("Email Forwards:") }</label>
          ${ h.tag.input(type="button", name="add_forwarding_field",
             value="Add Forwarding Field", onClick="addForwardsField()") }<br/>
          <py:if test="'mailForwardingAddress' in c.userinfo">
            <py:for each="n in range(c.lengths[uid].forwards or 1)">
              <xi:include href="snippets/forwards.html"/>
            </py:for>
          </py:if>
        </div>

        <button type="submit" name="Update"
          title="${ _('Update User Entry')}">${ _("Update") }</button>
        <input type="hidden" name="uid" value="${uid}" />
        <input type="hidden" name="ispmanUserId" value="${ c.userinfo['ispmanUserId'] }"/>
        <input type="hidden" name="ispmanDomain" value="${domain}" />
        <input type="hidden" name="mailLocalAddress"
          value="${c.userinfo['mailLocalAddress']}" />
        <input type="hidden" name="ispmanCreateTimestamp"
          value="${c.userinfo['ispmanCreateTimestamp']}"/>
      </fieldset>
    </form>
    <script type="text/javascript">checkFieldStatus();</script>
  </body>
</html>
<!--!
$Id: edituser.html 41 2006-11-08 14:24:50Z s0undt3ch $
vim: sw=2 ts=2 fenc=utf-8 ft=kid et
-->

